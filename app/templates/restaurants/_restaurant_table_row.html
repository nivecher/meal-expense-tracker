<tr>
    <td>
        <div class="d-flex align-items-center">
            <!-- Restaurant Icon (small for table view) -->
            <div class="restaurant-icon-table me-2 flex-shrink-0">
                {% if restaurant.website %}
                    <img
                        src="https://www.google.com/s2/favicons?domain={{ restaurant.website }}&sz=16"
                        alt="{{ restaurant.name }} icon"
                        class="restaurant-favicon-table"
                        width="16"
                        height="16"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';"
                    />
                    <i class="fas fa-utensils text-primary restaurant-fallback-icon-table" style="display: none; font-size: 14px;"></i>
                {% else %}
                    <i class="fas fa-utensils text-primary restaurant-fallback-icon-table" style="font-size: 14px;"></i>
                {% endif %}
            </div>

            <!-- Restaurant Name and Cuisine -->
            <div>
                <a href="{{ url_for('restaurants.restaurant_details', restaurant_id=restaurant.id) }}">{{ restaurant.name }}</a>
                {% if restaurant.cuisine %}
                <span class="cuisine-badge" data-cuisine="{{ restaurant.cuisine }}">
                    <span class="badge bg-light text-dark">{{ restaurant.cuisine }}</span>
                </span>
                {% endif %}
            </div>
        </div>
    </td>
    <td>
        <div class="d-flex align-items-center">
            <div>
                {% if restaurant.city or restaurant.state %}
                    {% set location_parts = [] %}
                    {% if restaurant.city %}{% set _ = location_parts.append(restaurant.city) %}{% endif %}
                    {% if restaurant.state %}{% set _ = location_parts.append(restaurant.state) %}{% endif %}
                    {{ location_parts|join(', ') }}
                {% else %}
                    <span class="text-muted">-</span>
                {% endif %}
            </div>
            {% set maps_url = restaurant|google_maps_url %}
            {% if maps_url %}
            <a href="{{ maps_url }}"
               target="_blank"
               rel="noopener noreferrer"
               class="btn btn-sm btn-outline-secondary ms-2"
               data-bs-toggle="tooltip"
               title="View on Google Maps">
                <i class="fas fa-map-marked-alt"></i>
            </a>
            {% endif %}
        </div>
    </td>
    <td>{{ restaurant.visit_count }}</td>
    <td class="fw-bold text-success amount-right">${{ "%.2f"|format(restaurant.total_spent) if restaurant.total_spent is defined else '0.00' }}</td>
    <td>
        {% if restaurant.rating %}
        <span
            class="badge bg-{{ 'success' if restaurant.rating >= 4 else 'warning' if restaurant.rating >= 3 else 'danger' }}">
            {{ "%.1f"|format(restaurant.rating) }}
        </span>
        {% else %}
        <span class="text-muted">No rating</span>
        {% endif %}
    </td>
    <td>
        {% if last_visit %}
        <span data-sort-value="{{ last_visit.isoformat() }}"
              data-bs-toggle="tooltip"
              title="{{ last_visit.strftime('%B %d, %Y at %I:%M %p') }}">
            {{ last_visit|time_ago }}
        </span>
        {% else %}
        <span class="text-muted" data-sort-value="">No visits</span>
        {% endif %}
    </td>
    <td class="actions">
        <a
            href="{{ url_for('restaurants.restaurant_details', restaurant_id=restaurant.id) }}"
            class="btn btn-sm btn-outline-primary"
            data-bs-toggle="tooltip"
            title="View Details">
            <i class="fas fa-eye"></i>
        </a>
        <a
            href="{{ url_for('restaurants.edit_restaurant', restaurant_id=restaurant.id) }}"
            class="btn btn-sm btn-outline-secondary"
            data-bs-toggle="tooltip"
            title="Edit">
            <i class="fas fa-edit"></i>
        </a>
        <button
            type="button"
            class="btn btn-sm btn-outline-danger"
            data-bs-toggle="modal"
            data-bs-target="#deleteRestaurantModal"
            data-restaurant-id="{{ restaurant.id }}"
            data-restaurant-name="{{ restaurant.name }}"
            data-bs-toggle="tooltip"
            title="Delete">
            <i class="fas fa-trash"></i>
        </button>
    </td>
</tr>
